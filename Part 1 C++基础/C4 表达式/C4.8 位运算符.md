# C4.8 位运算符
位运算符作用于整数类型的运算对象，并把运算对象看成二进制的集合。位运算符提供检查和设置二进制位的功能。

|运算符|功能|用法|
|---|---|---|
|`~`|位求反|`~expr`|
|`<<`|左移|`expr << expr2`|
|`>>`|右移|`expr >> expr2`|
|`&`|位与|`expr & expr`|
|`^`|位异或|`expr ^ expr`|
|`\|`|位或|`expr \| expr`|

一般来说，如果运算对象是“小整数”，则它的值会被自动提升成较大类型的整数类型。运算对象可以是带符号的，也可以是无符号的。如果运算对象是带符号的且它的值为负，那么位运算符如何处理运算对象的“符号位”依赖于机器。而且，此时的左移操作可能回改变符号的值，因此是一种未定义的行为。

## 移位运算符
**左移运算符** 在右侧插入值为0的二进制位。  
**右移运算符** 的行为依赖于其左侧运算对象的类型：  
如果该运算对象是无符号类型，在左侧插入值为0的二进制位；  
如果该运算对象时带符号类型，在左侧插入符号位的副本或值为0的二进制位，如何选择要视具体环境而定。

## 位求反运算符
**位求反运算符** 将运算对象逐位求反后生成一个新值，将1置为0、将0置为1；

类型提升也会发生

## 位与、位或、位异或运算符
**位与运算符**：如果两个运算对象的对应位置都是1，则运算结果中该位为1，否则为0.  
**位或运算符**：如果两个运算对象的对应位置至少有一个为1则运算结果中该位为1，否则为0.  
**位异或运算符**：如果两个对象的对应位置有且只有一个为1，则运算结果中该位为1，否则为0.

## 位运算符的简单使用
假设班级中有30个学生，老师每周都会对学生进行一次小测验，测验的结果只有通过和不通过两种。为了更好地追踪测验的结果，我们用一个二进制位代表某个学生在一次测验中是否通过，显然全班的测验结果可以用一个无符号整数来表示：
```cpp
unsigned long quiz = 0;
```

教师有权设置并检查每个二进制位。例如，我们需要对序号27的学生对应的位进行设置，以表示他通过了测验。为了达到这一目的，首先创建一个值，该值只要第27位是1其他位都是0，然后将这个值与`quiz`进行位或运算，这样就可以强行将`quiz`的第27位设置位1，其它位都保持不变。

使用左移运算符和一个`unsigned long`类型的整数字面值`1`，就能得到一个表示学生27通过了测验的数值：
```cpp
1UL << 27
```

接下来将所得到的值与`quiz`进行位或运算。为了同时更新`quiz`的值，使用一条复合赋值语句：
```cpp
quiz |= 1UL << 27;
```

假定老师发现学生27实际上并没有通过测验，他必须要把第27位的值设为0.此时我们需要使用一个特殊的整数，它的第27位是0、其他所有位都是1。将这个值与`quiz`进行位与运算就能实现目的了：
```cpp
quiz &= ~(1UL << 27);
```

最后我们试图检查学生27测验的情况到底怎么样：
```cpp
bool status = quiz & (1UL << 27);
```
