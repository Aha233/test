# C4.1 基础
表达式由一个或多个**运算对象（operand）** 组成，对表达式求值将得到一个**结果（result）**。字面值和变量是最简单的**表达式（expression）**，其结果就是字面值和变量的值。把一个**运算符（operator）** 和一个或多个运算对象组合起来就可以生成比较复杂的表达式。

## 基本概念
C++ 定义了**一元运算符（unary operator）** 和 **二元运算符（binary operator）** 。
> - 作用于一个运算对象的运算符就是一元运算符，如取地址符（`&`）和解引用符（`*`）；
> - 作用于两个运算对象的运算符是二元运算符，如相等运算符（`==`）和乘法运算符（`*`）。

还有一个作用于三个运算对象的三元运算符（`?`）。

函数调用也是一种特殊的运算符，它对运算对象的数量没有限制。

一些符号既能作为一元运算符，也能作为二元运算符，这由上下文决定。
### 组合运算符和运算对象
对于含有多个运算符的复杂表达式来说，要想理解它含义首先要理解运算符的**优先级（precedence）** 、**结合律（associativity）** 以及运算对象的**求值顺序（order of evaluation）** 。

### 运算对象转换
在表达式求值的过程中，运算对象常常由一种类型转换成另一种类型。 例如，尽管一般的二元运算符都要求两个运算对象的类型相同，但是很多时候即使运算对象的类型不同也没有关系，只要它们能被转换成同一种类型即可。

### 重载运算符
C++ 语言定义了运算符作用于内置类型和符合类型的运算对象时所执行的操作。  
当运算符作用于类类型的运算对象时，用户可以自定义其含义。因为这种自定义的过程事实上是为已存在的运算符赋予了另外一层含义，所以称之为**运算符重载（overload operator）** 。

当我们使用重载运算符时，其包括运算对象的类型和返回值的类型，都是由该运算符定义的；但是运算对象的个数、运算符的优先级和结合律都是无法改变的。

### 左值和右值
C++ 的表达式要不然是**右值（rvalue）** ，要不然就是**左值（lvalue）** 。  

一个左值表达式的求值结果是一个对象或者一个函数，然而以常量对象为代表的某些左值实际上不能作为赋值语句的左侧运算对象。此外，虽然某些表达式的求值结果是对象，但他们是右值而非左值。

**当一个对象被用作右值时，用的是对象的值（内容），当对象被用作左值的时候，用的是对象的身份（在内存中的位置）**

### 优先级和结合律
**符合表达式（compound expression）** 是指含有两个或多个运算符的表达式。求复合表达式的值需要首先将运算符和运算对象合理地组合在一起，优先级与结合律决定了运算对象组合的方式。表达式中的括号无视上述规则，程序员可以使用括号将表达式的某个局部括起来使其得到优先运算。

一般来说，表达式最终的值依赖于子表达式的组合方式。高优先级运算符的运算对象要比低优先级运算符的运算对象更为紧密地组合在一起。如果优先级相同，则其组合规律由结合律确定。

### 括号无视优先级和结合律
括号无视普通的组合规则，表达式中括号括起来的部分被当做一个单元来求值，然后再与其他部分一起按照优先级组合。

## 求值顺序
优先级规定了运算对象的组合方式，但没有说明运算符按照什么顺序求值。在大多数情况下，不会明确指定求值的顺序。
```cpp
int i = f1() * f2();
```

我们知道`f1` 和 `f2` 一定会在执行乘法之前被调用，因为毕竟相乘的是这两个函数的返回值。但我们无法知道到底`f1`在`f2`知足吗调用还是`f2`在`f1`之前调用。

对于那些没有指定执行顺序的运算符来说，如果表达式指向并修改了同一个对象，将会引发错误并产生未定义的行为。
```cpp
int i = 0;
cout << i << " " << ++i << endl;       //未定义的
```

因为程序是未定义的，所以我们无法推断它的行为。

有4种运算符明确规定了运算对象的求值顺序。
> - 逻辑与运算符（`&&`），它规定了先求左侧运算对象的值，只有当左侧运算对象的值为真时才继续求右侧运算对象的值。
> - 逻辑或运算符（`||`）
> - 条件运算符（`? :`）
> - 逗号运算符（`,`）

